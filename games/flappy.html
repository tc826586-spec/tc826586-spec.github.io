<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Flappy Bird</title>

<style>
html,body{
  margin:0;
  padding:0;
  height:100%;
}
body{
  background:#70c5ce;
  display:flex;
  justify-content:center;
  align-items:center;
  font-family:Arial,Helvetica,sans-serif;
}
canvas{
  background:#70c5ce;
  border-radius:10px;
}
#hint{
  position:absolute;
  top:15px;
  color:white;
  font-weight:bold;
}
</style>
</head>

<body>

<div id="hint">Tap / Click / Space</div>
<canvas id="c" width="360" height="520"></canvas>

<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");

let bird, pipes, frame, score, gameOver;

/* RESET GAME */
function reset(){
  bird = { x:60, y:200, v:0 };
  pipes = [];
  frame = 0;
  score = 0;
  gameOver = false;
}

/* DRAW BIRD */
function drawBird(){
  ctx.fillStyle="yellow";
  ctx.fillRect(bird.x, bird.y, 34, 24);
}

/* DRAW PIPES */
function drawPipes(){
  ctx.fillStyle="green";
  pipes.forEach(p=>{
    ctx.fillRect(p.x,0,50,p.top);
    ctx.fillRect(p.x,p.bottom,50,canvas.height);
  });
}

/* UPDATE */
function update(){
  if(gameOver) return;

  bird.v += 0.5;
  bird.y += bird.v;

  if(bird.y < 0) bird.y = 0;
  if(bird.y + 24 > canvas.height) gameOver = true;

  if(frame % 90 === 0){
    let gap = 140;
    let top = Math.random()*200 + 40;
    pipes.push({
      x:canvas.width,
      top:top,
      bottom:top + gap,
      passed:false
    });
  }

  pipes.forEach(p=>{
    p.x -= 2;

    if(
      bird.x < p.x + 50 &&
      bird.x + 34 > p.x &&
      (bird.y < p.top || bird.y + 24 > p.bottom)
    ){
      gameOver = true;
    }

    if(!p.passed && p.x + 50 < bird.x){
      score++;
      p.passed = true;
    }
  });

  pipes = pipes.filter(p=>p.x > -60);
}

/* DRAW */
function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  drawPipes();
  drawBird();

  ctx.fillStyle="white";
  ctx.font="28px Arial";
  ctx.fillText(score, canvas.width/2-10, 40);

  if(gameOver){
    ctx.fillStyle="rgba(0,0,0,.6)";
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle="white";
    ctx.font="24px Arial";
    ctx.fillText("Game Over",110,240);
    ctx.font="16px Arial";
    ctx.fillText("Tap to Restart",115,270);
  }
}

/* LOOP */
function loop(){
  frame++;
  update();
  draw();
  requestAnimationFrame(loop);
}

/* CONTROLS */
function flap(){
  if(gameOver){
    reset();
  }
  bird.v = -8;
}

document.addEventListener("keydown",e=>{
  if(e.code==="Space") flap();
});
canvas.addEventListener("mousedown",flap);
canvas.addEventListener("touchstart",flap);

/* START */
reset();
loop();
</script>

</body>
</html>
